---
    import { Image } from 'astro:assets';
---
<style>
	/* Skeleton Loading Styles */
	@keyframes pulse-bg {
		50% {
			background-color: #d4d4d8; /* zinc-300 */
		}
	}
	.skeleton {
		background-color: #e4e4e7; /* zinc-200 */
		border-radius: 0.25rem;
		animation: pulse-bg 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
	}
	.newest-posts-section.is-loading .content-wrapper {
		display: none;
	}
	.newest-posts-section:not(.is-loading) .skeleton-wrapper {
		display: none;
	}
	.slider-container-newest {
		position: relative;
		width: 100%;
		overflow: hidden;
	}
	.slider-wrapper-newest {
		display: flex;
		transition: transform 0.4s ease-in-out;
	}
	.slide-newest {
		flex-shrink: 0;
		width: 100%; /* Default for mobile */
	}
	@media (min-width: 768px) {
		.slide-newest {
			width: 50%;
		}
	}
	@media (min-width: 1024px) {
		.slide-newest {
			width: 25%;
		}
	}
	.slider-nav-btn-newest {
		position: absolute;
		top: 50%;
		transform: translateY(-50%);
		z-index: 10;
		background-color: #18181b; /* zinc-900 */
		color: #ffffff;
		width: 44px;
		height: 44px;
		border-radius: 9999px;
		transition: background-color 0.3s, opacity 0.3s;
		box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
		display: flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		border: none;
	}
	.slider-nav-btn-newest:hover {
		background-color: #3f3f46; /* zinc-700 */
	}
	.slider-nav-btn-newest:disabled {
		opacity: 0.5;
		cursor: not-allowed;
		background-color: #27272a; /* zinc-800 */
	}
	#prev-btn-newest {
		left: -1rem;
	}
	#next-btn-newest {
		right: -1rem;
	}
</style>

<section class="newest-posts-section w-full py-16 md:py-24 px-4 md:px-12 border border-zinc-900 relative is-loading">
	<!-- Skeleton Loader -->
	<div class="skeleton-wrapper">
		<div class="text-left mb-12">
			<div class="skeleton h-12 w-1/2 mb-4"></div>
			<div class="skeleton h-6 w-3/4"></div>
		</div>
		<div class="slider-container-newest">
			<div class="slider-wrapper-newest -mx-2 md:-mx-4">
				{Array(4).fill(0).map(() => (
					<div class="slide-newest px-2 md:px-4">
						<div class="border border-zinc-200/50 rounded-lg shadow-sm overflow-hidden h-full">
							<div class="skeleton w-full h-40"></div>
							<div class="p-4">
								<div class="skeleton h-4 w-1/4 mb-2"></div>
								<div class="skeleton h-5 w-3/4"></div>
							</div>
						</div>
					</div>
				))}
			</div>
		</div>
	</div>

	<!-- Real Content (hidden initially) -->
	<div class="content-wrapper">
		<div class="relative">
			<div class="text-left mb-12 animate-fade-in-up">
				<h2 class="text-4xl md:text-5xl font-black tracking-tighter">Newest From Crea-Tive</h2>
				<p class="text-lg text-zinc-600 mt-2 max-w-2xl">Stay up to date with our latest articles, news, and announcements.</p>
			</div>
			<div class="slider-container-newest animate-fade-in-up" style="animation-delay: 0.2s;">
				<div class="slider-wrapper-newest -mx-2 md:-mx-4">
					<!-- Post 1 -->
					<div class="slide-newest px-2 md:px-4">
						<div class="bg-white/50 backdrop-blur-sm border border-zinc-200/50 rounded-lg shadow-sm overflow-hidden group h-full flex flex-col">
							<a href="#" class="block">
								<Image src="https://images.unsplash.com/photo-1611162617213-6d221bde3840?q=80&w=800&auto=format&fit=crop" alt="Social media icons" width={800} height={533} class="w-full h-40 object-cover group-hover:scale-105 transition-transform duration-300" />
								<div class="p-4">
									<span class="text-xs font-bold uppercase text-zinc-500">Marketing</span>
									<h3 class="mt-2 text-md font-bold text-zinc-800">The Future of Social Media</h3>
								</div>
							</a>
						</div>
					</div>
					<!-- Post 2 -->
					<div class="slide-newest px-2 md:px-4">
						<div class="bg-white/50 backdrop-blur-sm border border-zinc-200/50 rounded-lg shadow-sm overflow-hidden group h-full flex flex-col">
							<a href="#" class="block">
								<img src="https://images.unsplash.com/photo-1551288049-bebda4e38f71?q=80&w=800&auto=format&fit=crop" alt="Data analytics dashboard" class="w-full h-40 object-cover group-hover:scale-105 transition-transform duration-300" />
								<div class="p-4">
									<span class="text-xs font-bold uppercase text-zinc-500">Data</span>
									<h3 class="mt-2 text-md font-bold text-zinc-800">Data-Driven Decisions</h3>
								</div>
							</a>
						</div>
					</div>
					<!-- Post 3 -->
					<div class="slide-newest px-2 md:px-4">
						<div class="bg-white/50 backdrop-blur-sm border border-zinc-200/50 rounded-lg shadow-sm overflow-hidden group h-full flex flex-col">
							<a href="#" class="block">
								<img src="https://images.unsplash.com/photo-1516321497487-e288fb19713f?q=80&w=800&auto=format&fit=crop" alt="People collaborating around a table" class="w-full h-40 object-cover group-hover:scale-105 transition-transform duration-300" />
								<div class="p-4">
									<span class="text-xs font-bold uppercase text-zinc-500">Teamwork</span>
									<h3 class="mt-2 text-md font-bold text-zinc-800">Effective Collaboration</h3>
								</div>
							</a>
						</div>
					</div>
					<!-- Post 4 -->
					<div class="slide-newest px-2 md:px-4">
						<div class="bg-white/50 backdrop-blur-sm border border-zinc-200/50 rounded-lg shadow-sm overflow-hidden group h-full flex flex-col">
							<a href="#" class="block">
								<img src="https://images.unsplash.com/photo-1581291518857-4e27b48ff24e?q=80&w=800&auto=format&fit=crop" alt="Modern design workspace" class="w-full h-40 object-cover group-hover:scale-105 transition-transform duration-300" />
								<div class="p-4">
									<span class="text-xs font-bold uppercase text-zinc-500">UI/UX</span>
									<h3 class="mt-2 text-md font-bold text-zinc-800">UI/UX Trends for 2024</h3>
								</div>
							</a>
						</div>
					</div>
				</div>
			</div>
			<!-- Slider Navigation -->
			<button id="prev-btn-newest" class="slider-nav-btn-newest" aria-label="Previous slide">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
			</button>
			<button id="next-btn-newest" class="slider-nav-btn-newest" aria-label="Next slide">
				<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
			</button>
		</div>
	</div>
</section>

<script is:inline>
	document.addEventListener('DOMContentLoaded', () => {
		const section = document.querySelector('.newest-posts-section');
        if (!section) return;

        // Simulate content loading
        setTimeout(() => {
            section.classList.remove('is-loading');

			// Initialize slider after content is shown
			const sliderContainer = section.querySelector('.slider-container-newest');
			if (!sliderContainer) return;

			const sliderWrapper = sliderContainer.querySelector('.slider-wrapper-newest');
			const slides = Array.from(sliderContainer.querySelectorAll('.slide-newest'));
			const prevBtn = document.getElementById('prev-btn-newest');
			const nextBtn = document.getElementById('next-btn-newest');
			const totalSlides = slides.length;

			let currentIndex = 0;
			let slidesToShow = 4;

			function updateSlidesToShow() {
				if (window.innerWidth < 768) {
					slidesToShow = 1;
				} else if (window.innerWidth < 1024) {
					slidesToShow = 2;
				} else {
					slidesToShow = 4;
				}
			}

			function updateSliderPosition() {
				const slideWidth = slides[0].offsetWidth;
				sliderWrapper.style.transform = `translateX(-${currentIndex * slideWidth}px)`;
				updateButtons();
			}

			function updateButtons() {
				prevBtn.disabled = currentIndex === 0;
				nextBtn.disabled = currentIndex >= totalSlides - slidesToShow;
			}

			function showNextSlide() {
				if (currentIndex < totalSlides - slidesToShow) {
					currentIndex++;
					updateSliderPosition();
				}
			}

			function showPrevSlide() {
				if (currentIndex > 0) {
					currentIndex--;
					updateSliderPosition();
				}
			}

			function init() {
				updateSlidesToShow();
				updateSliderPosition();
				nextBtn.addEventListener('click', showNextSlide);
				prevBtn.addEventListener('click', showPrevSlide);

				window.addEventListener('resize', () => {
					updateSlidesToShow();
					if (currentIndex > totalSlides - slidesToShow) {
						currentIndex = Math.max(0, totalSlides - slidesToShow);
					}
					updateSliderPosition();
				});
			}

			init();
		}, 1500); // 1.5s delay to simulate loading. You can adjust or remove this.
	});
</script>